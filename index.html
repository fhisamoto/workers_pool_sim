<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <script>
    var Job = function() {
      var gaussRandom = function () {
         var u = 2 * Math.random() - 1;
         var v = 2 * Math.random() - 1;
         var r = u * u + v * v;
         if (r == 0 || r > 1) return gaussRandom();
         var c = Math.sqrt(-2 * Math.log(r) / r);
         return u * c;
      }
      this.processTime = gaussRandom() + 10.0;

      this.execute = function(onComplete) {
        return setTimeout(function() { onComplete() } , this.processTime * 100);
      };
      return this;
    };

    var Worker = function() {
      this.jobs = [];

      this.idle = function() {
        return (this.jobs.length == 0);
      };

      this.pullJobs = function() {
        var worker = this;
        if (this.jobs[0]) {
          var id = this.jobs[0].execute(function() {
            console.log("Job[" + id + "] Completed.");
            worker.jobs.shift();
            worker.pullJobs();
          });
        }
      };

      this.addJob = function(job) {
        if (this.idle()) {
          this.jobs.push(job);
          this.pullJobs();
        } else {
          this.jobs.push(job);
        }
      };

      return this;
    }

    var WorkersPool = function() {
      this.MAX_WORKERS = 10;
      this.workers = [];
      for (var i = 0; i < this.MAX_WORKERS; i++) {
        this.workers.push(new Worker());
      }

      this.addJob = function(job) {
        var i = Math.floor(Math.random() * this.MAX_WORKERS);
        this.workers[i].addJob(job);
      };

      return this;
    };
  </script>
</head>
<body>
</body>
</html>